# steps:
#   - name: "bash"
#     args: ["ls", "-alh"]
#   - name: "bash"
#     args: ["pwd"]
#   - name: "gcr.io/google.com/cloudsdktool/cloud-sdk"
#     entrypoint: "gcloud"
#     args: ["compute", "scp", "--recurse", "--tunnel-through-iap", "~/*", "lakshay_kumar@cluster-0cda-m:/home/lakshay_kumar/", "--zone=us-central1-a"]
# options:
#   logging: CLOUD_LOGGING_ONLY
steps:
  - name: 'gcr.io/cloud-builders/git'
    entrypoint: 'git'
    args: ["clone","https://github.com/LakshayGujjar/terraform-with-gcp.git"]
  - name: "gcr.io/google.com/cloudsdktool/cloud-sdk"
    entrypoint: "gsutil"
    args: ["-m", "cp", "-r", "./terraform-with-gcp/*", "gs://bitbucket-bin-file/$COMMIT_SHA/"]
  - name: "gcr.io/google.com/cloudsdktool/cloud-sdk"
    entrypoint: "gcloud"
    args: ["compute", "scp", "--recurse", "--tunnel-through-iap", "./terraform-with-gcp/*", "lakshay_kumar@cluster-0cda-m:/home/lakshay_kumar/", "--zone=us-central1-a]
options:
  logging: CLOUD_LOGGING_ONLY